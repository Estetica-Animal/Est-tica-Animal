<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Estética Animal — Agenda & Tutores</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
:root{
  --rosa:#ff66a3;
  --rosa-escuro:#ff3385;
  --bg:#fff0f6;
  --card:#ffffff;
  --texto:#444;
  --sombra:0 4px 8px rgba(255,102,163,.3);
  --azul:#007bff;
  --verde:#28a745;
  --cinza:#d6d6d6;
}
*{box-sizing:border-box}
body{font-family:Arial,Helvetica,sans-serif; background:var(--bg); color:var(--texto); margin:0; position:relative; min-height:100vh;}
header{position:fixed; top:0; left:0; right:0; background:var(--rosa); color:#fff; z-index:1000; box-shadow:var(--sombra);}
.header-inner{max-width:1200px; margin:0 auto; padding:12px 16px; display:flex; align-items:center; justify-content:center; gap:50px;}
header h1{margin:0; font-size:20px; display:flex; align-items:center; gap:10px;}
#logoHeader{width:40px;height:40px;border-radius:50%;object-fit:cover;}
nav{display:flex; gap:20px; justify-content:center; align-items:center;}
nav a{display:inline-block; color:#fff; text-decoration:none; font-weight:bold; padding:8px 12px; border-radius:20px; transition:.2s;}
nav a:hover{background:#fff; color:var(--rosa)}
nav a.ativo{background:#fff; color:var(--rosa)}
main{max-width:1200px; margin:0 auto 24px; padding:100px 16px 24px 16px;}

/* ======= AGENDA ======= */
#agendaMain{display:flex; gap:20px; align-items:flex-start}
#calendario{flex:1; max-height:78vh; overflow-y:auto;}
.mes{background:var(--card); border-radius:14px; padding:12px; margin-bottom:20px; box-shadow:var(--sombra);}
.mes h2{margin:6px 0 12px; text-transform:capitalize; color:var(--rosa-escuro); text-align:center}
.dias-semana{display:grid; grid-template-columns:repeat(7,1fr); margin-bottom:6px; text-align:center; font-weight:bold; font-size:12px;}
.dias{display:grid; grid-template-columns:repeat(7,1fr); gap:6px;}
.dia{background:#ffe6f0; border-radius:8px; min-height:86px; padding:6px; position:relative; font-size:12px;}
.dia-num{font-weight:bold; opacity:.8}
.dia.hoje{outline:2px solid var(--rosa-escuro); background:#ffd1e3}
.badge{display:block; width:100%; text-align:left; border:none; border-radius:8px; color:#fff; padding:6px 8px; margin-top:6px; cursor:pointer; font-size:12px; line-height:1.2; box-shadow:0 2px 6px rgba(0,0,0,.08);}
.badge.avulso{background:var(--azul)}
.badge.pacote{background:var(--verde)}

/* Sidebar form */
#sidebar{width:320px; background:var(--card); border-radius:14px; padding:16px; box-shadow:var(--sombra); position:sticky; top:92px;}
#sidebar h3{margin-top:0; color:var(--rosa-escuro); text-align:center}
.field{margin-bottom:10px}
.field label{display:block; font-size:13px; margin-bottom:4px}
.field input, .field select{width:100%; padding:10px; border:2px solid var(--rosa); border-radius:10px; background:#fff;}
.btn{display:inline-block; width:100%; border:none; border-radius:10px; padding:10px 12px; font-weight:bold; cursor:pointer; transition:.2s; box-shadow:var(--sombra);}
.btn:hover{transform:translateY(-1px)}
.btn-avulso{background:var(--azul); color:#fff}
.btn-editar{background:#ffc107; color:#fff; margin-top:6px;}
.btn-excluir{background:#dc3545; color:#fff; margin-top:6px;}

/* ======= TUTORES ======= */
#tutoresSec{display:none; display:grid; grid-template-columns:1fr; gap:20px;}
#formTutor, #formAnimal, #listaTutores{background:var(--card); padding:16px; border-radius:14px; box-shadow:var(--sombra);}
#listaTutores h3{margin-top:0; color:var(--rosa-escuro);}
.tutor-card{border-bottom:1px solid #eee; padding:10px 0; display:flex; flex-direction:column; gap:6px;}
.tutor-card span{font-size:14px;}
.animal{display:flex; align-items:center; gap:10px; margin-top:6px;}
.animal img{width:40px; height:40px; border-radius:50%; object-fit:cover;}
.icon-btn{background:none;border:none;cursor:pointer;font-size:16px;color:var(--rosa-escuro);margin-left:6px;}
.icon-btn:hover{color:var(--rosa)}

/* LOGIN */
#loginScreen{position:fixed; inset:0; background:rgba(255,255,255,0.95); display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:3000;}
#loginScreen h2{margin-bottom:20px; color:var(--rosa-escuro);}
#loginScreen input{width:220px; padding:10px; margin:6px 0; border:2px solid var(--rosa); border-radius:10px;}
#loginScreen button{width:100%; max-width:240px; padding:10px; margin-top:12px; background:var(--rosa); color:#fff; border:none; border-radius:10px; font-weight:bold; cursor:pointer;}
#loginScreen #logoLogin{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:12px;}

/* Marca d'água */
footer{position:absolute; bottom:0; left:0; width:100%; text-align:center; font-size:12px; color:#aaa; padding:12px;}
</style>
</head>
<body>

<div id="loginScreen">
  <img src="logo.png" alt="Logo" id="logoLogin">
  <h2>Login Estética Animal</h2>
  <input type="text" id="loginUser" placeholder="Usuário" />
  <input type="password" id="loginPass" placeholder="Senha" />
  <button onclick="fazerLogin()">Entrar</button>
</div>

<header>
  <div class="header-inner">
    <h1><img src="logo.png" alt="Logo" id="logoHeader"> Estética Animal</h1>
    <nav>
      <a href="#" id="navAgenda" class="ativo" onclick="mostrarAgenda(event)">Agenda</a>
      <a href="#" id="navTutores" onclick="mostrarTutores(event)">Controle de Tutores</a>
    </nav>
  </div>
</header>

<main>
  <!-- ======= AGENDA ======= -->
  <section id="agendaMain">
    <div id="calendario"></div>
    <aside id="sidebar">
      <h3>Adicionar Banho</h3>
      <div class="field"><label>Tipo</label>
        <select id="tipoBanho" onchange="togglePacoteOptions()">
          <option value="avulso">Avulso</option>
          <option value="pacote">Pacote</option>
        </select>
      </div>
      <div class="field" id="pacoteOptions" style="display:none">
        <label>Pacote</label>
        <select id="pacoteSelecionado">
          <option value="3">Pacote 3 banhos (1x por semana / 3 semanas)</option>
          <option value="4">Pacote 4 banhos (1x por semana / 4 semanas)</option>
        </select>
      </div>
      <div class="field"><label for="tutorSelect">Tutor</label>
        <select id="tutorSelect" onchange="carregarAnimais()">
          <option value="">Selecione um tutor</option>
        </select>
      </div>
      <div class="field"><label for="animalSelect">Cliente</label>
        <select id="animalSelect">
          <option value="">Selecione um cliente</option>
        </select>
      </div>
      <div class="field"><label for="dataBanho">Data</label><input type="date" id="dataBanho" /></div>
      <div class="field"><label for="horario">Horário</label><input type="time" id="horario" /></div>
      <div class="field"><label for="valor">Valor</label><input type="number" id="valor" step="0.01" min="0" /></div>
      <button class="btn btn-avulso" onclick="adicionarBanho()">Adicionar</button>
    </aside>
  </section>

  <!-- ======= CONTROLE DE TUTORES ======= -->
  <section id="tutoresSec">
    <div id="formTutor">
      <h3>Cadastrar Tutor</h3>
      <div class="field"><input type="text" id="tutorNome" placeholder="Nome completo" /></div>
      <div class="field"><input type="text" id="tutorEndereco" placeholder="Endereço" /></div>
      <div class="field"><input type="text" id="tutorTelefone" placeholder="Telefone" /></div>
      <button class="btn btn-avulso" onclick="adicionarTutor()">Salvar Tutor</button>
    </div>
    <div id="formAnimal">
      <h3>Adicionar Cliente</h3>
      <div class="field"><select id="animalTutor"></select></div>
      <div class="field"><input type="text" id="animalNome" placeholder="Nome do Cliente" /></div>
      <div class="field"><input type="file" id="animalFoto" accept="image/*" /></div>
      <button class="btn btn-avulso" onclick="adicionarAnimal()">Salvar Cliente</button>
    </div>
    <div id="listaTutores">
      <h3>Tutores Registrados</h3>
      <div id="tutoresContainer"></div>
    </div>
  </section>
</main>

<footer>Desenvolvido por Leocir</footer>

<script>
/* LOGIN */
const usuarios=[{user:'Kamilly',pass:'petshop2025'},{user:'Leocir',pass:'admin'}];
function fazerLogin(){
  const u=document.getElementById('loginUser').value.trim();
  const p=document.getElementById('loginPass').value.trim();
  const ok=usuarios.find(x=>x.user===u&&x.pass===p);
  if(ok){document.getElementById('loginScreen').style.display='none'; mostrarAgenda();}
  else alert('Usuário ou senha incorretos');
}

/* STORAGE */
const LS_TUTORES='tutores';
const LS_BANHOS='banhos';
const uid=()=>Date.now().toString(36)+Math.random().toString(36).slice(2,8);
const load=(k)=>JSON.parse(localStorage.getItem(k)||'[]');
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

/* NAV */
function setAtivo(id){document.querySelectorAll('nav a').forEach(a=>a.classList.remove('ativo'));document.getElementById(id).classList.add('ativo');}
function mostrarAgenda(e){if(e)e.preventDefault();document.getElementById('agendaMain').style.display='flex';document.getElementById('tutoresSec').style.display='none';setAtivo('navAgenda');renderCalendario();atualizarTutoresSelect();}
function mostrarTutores(e){if(e)e.preventDefault();document.getElementById('agendaMain').style.display='none';document.getElementById('tutoresSec').style.display='grid';setAtivo('navTutores');renderTutores();}

/* TUTORES */
//... (mantém funções de adicionar/editar/excluir tutores e clientes, iguais ao código anterior) ...

/* BANHOS */
function adicionarBanho(){
  const tipo=document.getElementById('tipoBanho').value;
  const pacote=document.getElementById('pacoteSelecionado').value;
  const tutor=document.getElementById('tutorSelect').value;
  const animal=document.getElementById('animalSelect').value;
  const data=document.getElementById('dataBanho').value;
  const horario=document.getElementById('horario').value;
  const valor=document.getElementById('valor').value;
  if(!tutor||!animal||!data||!horario||!valor) return alert('Preencha todos os campos');
  const banhos=load(LS_BANHOS);
  if(tipo==='avulso'){ 
    banhos.push({id:uid(),tutor,animal,data,horario,valor,status:'pago',tipo:'avulso',ordem:1,total:1}); 
  } else {
    const n=parseInt(pacote);
    for(let i=0;i<n;i++){
      const d=new Date(data);
      d.setDate(d.getDate()+7*i);
      banhos.push({id:uid(),tutor,animal,data:d.toISOString().split('T')[0],horario,valor:i===0?valor:'',tipo:'pacote',ordem:i+1,total:n});
    }
  }
  save(LS_BANHOS,banhos);
  renderCalendario();
}

/* CALENDARIO COM SEGUNDA-FEIRA COMO PRIMEIRO DIA */
function renderCalendario(){
  const container=document.getElementById('calendario'); container.innerHTML='';
  const hoje=new Date();
  const banhos=load(LS_BANHOS);
  const tutores=load(LS_TUTORES);
  const meses=[hoje.getMonth(),hoje.getMonth()+1];
  meses.forEach(m=>{
    const mesDate=new Date(hoje.getFullYear(),m,1);
    const mesDiv=document.createElement('div'); mesDiv.className='mes';
    const nomeMes=mesDate.toLocaleString('pt-BR',{month:'long',year:'numeric'});
    mesDiv.innerHTML=`<h2>${nomeMes}</h2>`;
    const diasSemana=['Seg','Ter','Qua','Qui','Sex','Sab','Dom'];
    const ds=document.createElement('div'); ds.className='dias-semana';
    diasSemana.forEach(d=>ds.innerHTML+=`<div>${d}</div>`); mesDiv.appendChild(ds);
    const diasContainer=document.createElement('div'); diasContainer.className='dias';
    const firstDay=(new Date(hoje.getFullYear(),m,1).getDay()+6)%7; // Ajuste: segunda=0
    const lastDay=new Date(hoje.getFullYear(),m+1,0).getDate();
    for(let i=0;i<firstDay;i++){const d=document.createElement('div'); diasContainer.appendChild(d);}
    for(let d=1;d<=lastDay;d++){
      const diaDiv=document.createElement('div'); diaDiv.className='dia';
      const dataStr=new Date(hoje.getFullYear(),m,d).toISOString().split('T')[0];
      if(d===hoje.getDate()&&m===hoje.getMonth()) diaDiv.classList.add('hoje');
      diasContainer.appendChild(diaDiv);
      banhos.filter(b=>b.data===dataStr).forEach(b=>{
        const t=tutores.find(t=>t.id===b.tutor);
        const a=t?t.animais.find(an=>an.id===b.animal):null;
        const nomeCliente=a?a.nome:'';
        let txt=b.tipo==='pacote'?`Banho ${b.ordem}/${b.total} - ${nomeCliente}`:`${nomeCliente} - R$${b.valor}`;
        if(b.tipo==='pacote' && b.ordem===1) txt+=` - Pago`;
        const btn=document.createElement('button'); btn.className='badge '+b.tipo; btn.textContent=txt;
        diaDiv.appendChild(btn);
      });
    }
    mesDiv.appendChild(diasContainer);
    container.appendChild(mesDiv);
  });
}

function togglePacoteOptions(){document.getElementById('pacoteOptions').style.display=document.getElementById('tipoBanho').value==='pacote'?'block':'none';}

/* Inicialização */
mostrarAgenda();
</script>

</body>
</html>
