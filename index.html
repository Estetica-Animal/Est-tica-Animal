<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Estética Animal — Agenda & Tutores</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{
  --rosa:#ff66a3;
  --rosa-escuro:#ff3385;
  --bg:#fff0f6;
  --card:#ffffff;
  --texto:#444;
  --sombra:0 4px 8px rgba(255,102,163,.3);
  --azul:#007bff;
  --verde:#28a745;
  --cinza:#d6d6d6;
}
*{box-sizing:border-box}
body{font-family:Arial,Helvetica,sans-serif; background:var(--bg); color:var(--texto); margin:0;}

header{
  position:fixed; top:0; left:0; right:0; background:var(--rosa); color:#fff; z-index:1000; box-shadow:var(--sombra);
}
.header-inner{
  max-width:1200px; margin:0 auto; padding:12px 16px; display:flex; align-items:center; justify-content:space-between;
}
header h1{
  margin:0; font-size:20px; display:flex; align-items:center; gap:10px;
}
#logoHeader{width:40px;height:40px;border-radius:50%;object-fit:cover;}
nav{display:flex; gap:20px; justify-content:center; align-items:center; flex:1;}
nav a{display:inline-block; color:#fff; text-decoration:none; font-weight:bold; padding:8px 12px; border-radius:20px; transition:.2s;}
nav a:hover{background:#fff; color:var(--rosa)}
nav a.ativo{background:#fff; color:var(--rosa)}

main{max-width:1200px; margin:0 auto 24px; padding:100px 16px 24px 16px;}

/* ======= AGENDA ======= */
#agendaMain{display:flex; gap:20px; align-items:flex-start}
#calendario{flex:1; max-height:78vh; overflow-y:auto;}
.mes{background:var(--card); border-radius:14px; padding:12px; margin-bottom:20px; box-shadow:var(--sombra);}
.mes h2{margin:6px 0 12px; text-transform:capitalize; color:var(--rosa-escuro); text-align:center}
.dias-semana{display:grid; grid-template-columns:repeat(7,1fr); margin-bottom:6px; text-align:center; font-weight:bold; font-size:12px;}
.dias{display:grid; grid-template-columns:repeat(7,1fr); gap:6px;}
.dia{background:#ffe6f0; border-radius:8px; min-height:86px; padding:6px; position:relative; font-size:12px;}
.dia-num{font-weight:bold; opacity:.8}
.dia.hoje{outline:2px solid var(--rosa-escuro); background:#ffd1e3}
.badge{display:block; width:100%; text-align:left; border:none; border-radius:8px; color:#fff; padding:6px 8px; margin-top:6px; cursor:pointer; font-size:12px; line-height:1.2; box-shadow:0 2px 6px rgba(0,0,0,.08);}
.badge.avulso{background:var(--azul)}
.badge.pacote{background:var(--verde)}

#sidebar{width:320px; background:var(--card); border-radius:14px; padding:16px; box-shadow:var(--sombra); position:sticky; top:92px;}
#sidebar h3{margin-top:0; color:var(--rosa-escuro); text-align:center}
.field{margin-bottom:10px}
.field label{display:block; font-size:13px; margin-bottom:4px}
.field input, .field select{width:100%; padding:10px; border:2px solid var(--rosa); border-radius:10px; background:#fff;}
.btn{display:inline-block; width:100%; border:none; border-radius:10px; padding:10px 12px; font-weight:bold; cursor:pointer; transition:.2s; box-shadow:var(--sombra);}
.btn:hover{transform:translateY(-1px)}
.btn-avulso{background:var(--azul); color:#fff}

/* ======= TUTORES ======= */
#tutoresSec{display:none; display:grid; grid-template-columns:1fr; gap:20px;}
#formTutor, #formAnimal, #listaTutores{background:var(--card); padding:16px; border-radius:14px; box-shadow:var(--sombra);}
#listaTutores h3{margin-top:0; color:var(--rosa-escuro);}
.tutor-card{border-bottom:1px solid #eee; padding:10px 0; display:flex; flex-direction:column; gap:6px;}
.tutor-card span{font-size:14px;}
.animal{display:flex; align-items:center; gap:10px; margin-top:6px; justify-content:space-between;}
.animal img{width:40px; height:40px; border-radius:50%; object-fit:cover;}
.edit-icon{cursor:pointer; color:var(--rosa-escuro);}
.edit-icon:hover{color:var(--rosa);}

/* ======= LOGIN ======= */
#loginScreen{position:fixed; inset:0; background:rgba(255,255,255,0.95); display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:3000;}
#loginScreen h2{margin-bottom:20px; color:var(--rosa-escuro);}
#loginScreen input{width:220px; padding:10px; margin:6px 0; border:2px solid var(--rosa); border-radius:10px;}
#loginScreen button{width:100%; max-width:240px; padding:10px; margin-top:12px; background:var(--rosa); color:#fff; border:none; border-radius:10px; font-weight:bold; cursor:pointer;}
#loginScreen #logoLogin{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:12px;}
</style>
</head>
<body>

<div id="loginScreen">
  <img src="logo.png" alt="Logo" id="logoLogin">
  <h2>Login Estética Animal</h2>
  <input type="text" id="loginUser" placeholder="Usuário" />
  <input type="password" id="loginPass" placeholder="Senha" />
  <button onclick="fazerLogin()">Entrar</button>
</div>

<header>
  <div class="header-inner">
    <h1><img src="logo.png" alt="Logo" id="logoHeader"> Estética Animal</h1>
    <nav>
      <a href="#" id="navAgenda" class="ativo" onclick="mostrarAgenda(event)">Agenda</a>
      <a href="#" id="navTutores" onclick="mostrarTutores(event)">Controle de Tutores</a>
    </nav>
  </div>
</header>

<main>
  <!-- ======= AGENDA ======= -->
  <section id="agendaMain">
    <div id="calendario"></div>
    <aside id="sidebar">
      <h3>Adicionar Banho</h3>
      <div class="field"><label>Tipo</label>
        <select id="tipoBanho" onchange="togglePacoteOptions()">
          <option value="avulso">Avulso</option>
          <option value="pacote">Pacote</option>
        </select>
      </div>
      <div class="field" id="pacoteOptions" style="display:none">
        <label>Pacote</label>
        <select id="pacoteSelecionado">
          <option value="3">Pacote 3 banhos (1x por semana / 3 semanas)</option>
          <option value="4">Pacote 4 banhos (1x por semana / 4 semanas)</option>
        </select>
      </div>
      <div class="field"><label for="tutorSelect">Tutor</label>
        <select id="tutorSelect" onchange="carregarAnimais()">
          <option value="">Selecione um tutor</option>
        </select>
      </div>
      <div class="field"><label for="animalSelect">Cliente</label>
        <select id="animalSelect">
          <option value="">Selecione um cliente</option>
        </select>
      </div>
      <div class="field"><label for="dataBanho">Data</label><input type="date" id="dataBanho" /></div>
      <div class="field"><label for="horario">Horário</label><input type="time" id="horario" /></div>
      <div class="field"><label for="valor">Valor</label><input type="number" id="valor" step="0.01" min="0" /></div>
      <button class="btn btn-avulso" onclick="adicionarBanho()">Adicionar</button>
    </aside>
  </section>

  <!-- ======= CONTROLE DE TUTORES ======= -->
  <section id="tutoresSec">
    <div id="formTutor">
      <h3>Cadastrar Tutor</h3>
      <input type="text" id="tutorNome" placeholder="Nome completo" /><br>
      <input type="text" id="tutorEndereco" placeholder="Endereço" /><br>
      <input type="text" id="tutorTelefone" placeholder="Telefone" /><br>
      <button class="btn btn-avulso" onclick="adicionarTutor()">Salvar Tutor</button>
    </div>
    <div id="formAnimal">
      <h3>Adicionar Cliente</h3>
      <select id="animalTutor"></select><br>
      <input type="text" id="animalNome" placeholder="Nome do Cliente" /><br>
      <input type="file" id="animalFoto" accept="image/*" /><br>
      <button class="btn btn-avulso" onclick="adicionarAnimal()">Salvar Cliente</button>
    </div>
    <div id="listaTutores">
      <h3>Tutores Registrados</h3>
      <div id="tutoresContainer"></div>
    </div>
  </section>
</main>

<script>
/* LOGIN */
const usuarios=[{user:'Kamilly',pass:'petshop2025'},{user:'Leocir',pass:'admin'}];
function fazerLogin(){
  const u=document.getElementById('loginUser').value.trim();
  const p=document.getElementById('loginPass').value.trim();
  const ok=usuarios.find(x=>x.user===u&&x.pass===p);
  if(ok){document.getElementById('loginScreen').style.display='none'; mostrarAgenda();}
  else alert('Usuário ou senha incorretos');
}

/* STORAGE */
const LS_TUTORES='tutores';
const LS_BANHOS='banhos';
const uid=()=>Date.now().toString(36)+Math.random().toString(36).slice(2,8);
const load=(k)=>JSON.parse(localStorage.getItem(k)||'[]');
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

/* NAV */
function setAtivo(id){document.querySelectorAll('nav a').forEach(a=>a.classList.remove('ativo'));document.getElementById(id).classList.add('ativo');}
function mostrarAgenda(e){if(e)e.preventDefault();document.getElementById('agendaMain').style.display='flex';document.getElementById('tutoresSec').style.display='none';setAtivo('navAgenda');renderCalendario();atualizarTutoresSelect();}
function mostrarTutores(e){if(e)e.preventDefault();document.getElementById('agendaMain').style.display='none';document.getElementById('tutoresSec').style.display='grid';setAtivo('navTutores');renderTutores();}

/* TUTORES */
function adicionarTutor(){
  const nome=document.getElementById('tutorNome').value.trim();
  const endereco=document.getElementById('tutorEndereco').value.trim();
  const tel=document.getElementById('tutorTelefone').value.trim();
  if(!nome) return alert('Informe o nome');
  const tutores=load(LS_TUTORES);
  tutores.push({id:uid(),nome,endereco,tel,animais:[]});
  save(LS_TUTORES,tutores);
  document.getElementById('tutorNome').value=''; document.getElementById('tutorEndereco').value=''; document.getElementById('tutorTelefone').value='';
  renderTutores(); atualizarTutoresSelect();
}
function adicionarAnimal(){
  const tutorId=document.getElementById('animalTutor').value;
  const nome=document.getElementById('animalNome').value.trim();
  const file=document.getElementById('animalFoto').files[0];
  if(!tutorId||!nome) return alert('Preencha os campos');
  if(file){
    const reader=new FileReader();
    reader.onload=function(e){salvarAnimal(tutorId,nome,e.target.result)};
    reader.readAsDataURL(file);
  } else salvarAnimal(tutorId,nome,'');
}
function salvarAnimal(tutorId,nome,foto){
  const tutores=load(LS_TUTORES);
  const t=tutores.find(x=>x.id===tutorId);
  if(!t) return;
  t.animais.push({id:uid(),nome,foto});
  save(LS_TUTORES,tutores);
  document.getElementById('animalNome').value=''; document.getElementById('animalFoto').value='';
  renderTutores(); atualizarTutoresSelect();
}
function renderTutores(){
  const tutores=load(LS_TUTORES);
  const container=document.getElementById('tutoresContainer');
  const sel=document.getElementById('animalTutor');
  container.innerHTML=''; sel.innerHTML='<option value="">Selecione um Tutor</option>';
  tutores.forEach(t=>{
    sel.innerHTML+=`<option value="${t.id}">${t.nome}</option>`;
    const div=document.createElement('div');
    div.classList.add('tutor-card');
    div.innerHTML=`<strong>${t.nome}</strong><br>${t.endereco} - ${t.tel}`;
    const btnEditar=document.createElement('i');
    btnEditar.classList.add('fa-solid','fa-pencil','edit-icon');
    btnEditar.title='Editar Tutor';
    btnEditar.onclick=()=>editarTutor(t.id);
    div.appendChild(btnEditar);
    t.animais.forEach(a=>{
      const an=document.createElement('div');
      an.classList.add('animal');
      if(a.foto) an.innerHTML=`<div style="display:flex;align-items:center;gap:6px;"><img src="${a.foto}"><span>${a.nome}</span></div>`;
      else an.innerHTML=`<span>${a.nome}</span>`;
      const editAni=document.createElement('i');
      editAni.classList.add('fa-solid','fa-pencil','edit-icon');
      editAni.title='Editar Cliente';
      editAni.onclick=()=>editarAnimal(t.id,a.id);
      an.appendChild(editAni);
      div.appendChild(an);
    });
    container.appendChild(div);
  });
}
function editarTutor(id){
  const tutores=load(LS_TUTORES);
  const t=tutores.find(x=>x.id===id);
  if(!t) return;
  const nome=prompt("Editar nome do tutor:", t.nome);
  const endereco=prompt("Editar endereço:", t.endereco);
  const tel=prompt("Editar telefone:", t.tel);
  if(nome && endereco && tel){
    t.nome=nome; t.endereco=endereco; t.tel=tel;
    save(LS_TUTORES,tutores);
    renderTutores();
    atualizarTutoresSelect();
  }
}
function editarAnimal(tutorId,animalId){
  const tutores=load(LS_TUTORES);
  const t=tutores.find(x=>x.id===tutorId);
  if(!t) return;
  const a=t.animais.find(x=>x.id===animalId);
  if(!a) return;
  const nome=prompt("Editar nome do cliente:", a.nome);
  if(nome){
    a.nome=nome;
    save(LS_TUTORES,tutores);
    renderTutores();
    atualizarTutoresSelect();
  }
}

/* BANHOS */
function adicionarBanho(){
  const tipo=document.getElementById('tipoBanho').value;
  const tutorId=document.getElementById('tutorSelect').value;
  const animalId=document.getElementById('animalSelect').value;
  const data=document.getElementById('dataBanho').value;
  const horario=document.getElementById('horario').value;
  const valor=parseFloat(document.getElementById('valor').value)||0;
  const pacote=(tipo==='pacote')?document.getElementById('pacoteSelecionado').value:null;
  if(!tutorId||!animalId||!data||!horario) return alert('Preencha todos os campos');
  const tutores=load(LS_TUTORES);
  const tutor=tutores.find(t=>t.id===tutorId);
  const animal=tutor?.animais.find(a=>a.id===animalId);
  const banhos=load(LS_BANHOS);
  banhos.push({id:uid(),tipo,tutor:tutor?.nome,animal:animal?.nome,data,horario,valor,pacote,status:''});
  save(LS_BANHOS,banhos);
  renderCalendario();
}

/* SELECT TUTORES/ANIMAIS */
function atualizarTutoresSelect(){
  const tutores=load(LS_TUTORES);
  const sel=document.getElementById('tutorSelect');
  sel.innerHTML='<option value="">Selecione um tutor</option>';
  tutores.forEach(t=>{ sel.innerHTML+=`<option value="${t.id}">${t.nome}</option>` });
  carregarAnimais();
}
function carregarAnimais(){
  const tutorId=document.getElementById('tutorSelect').value;
  const tutores=load(LS_TUTORES);
  const tutor=tutores.find(t=>t.id===tutorId);
  const sel=document.getElementById('animalSelect');
  sel.innerHTML='<option value="">Selecione um cliente</option>';
  if(tutor){ tutor.animais.forEach(a=>{ sel.innerHTML+=`<option value="${a.id}">${a.nome}</option>` }) }
}
function togglePacoteOptions(){
  const tipo=document.getElementById('tipoBanho').value;
  document.getElementById('pacoteOptions').style.display=(tipo==='pacote')?'block':'none';
}

/* CALENDÁRIO */
const nomesMeses=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];
const nomesDias=["Seg","Ter","Qua","Qui","Sex","Sáb","Dom"];
let hoje=new Date();
function renderCalendario(){
  const calendario=document.getElementById('calendario');
  calendario.innerHTML='';
  const banhos=load(LS_BANHOS);
  for(let m=0; m<=1; m++){
    let mes=hoje.getMonth()+m;
    let ano=hoje.getFullYear();
    if(mes>11){ mes=mes-12; ano+=1; }
    const primeiroDia=new Date(ano,mes,1);
    const ultimoDia=new Date(ano,mes+1,0);
    const diasMes=ultimoDia.getDate();
    const primeiroDiaSemana=(primeiroDia.getDay()+6)%7;
    const mesDiv=document.createElement('div');
    mesDiv.classList.add('mes');
    mesDiv.innerHTML=`<h2>${nomesMeses[mes]} ${ano}</h2>
      <div class="dias-semana">${nomesDias.map(d=>`<div>${d}</div>`).join('')}</div>
      <div class="dias"></div>`;
    const diasGrid=mesDiv.querySelector('.dias');
    for(let i=0;i<primeiroDiaSemana;i++){ diasGrid.appendChild(document.createElement('div')); }
    for(let d=1; d<=diasMes; d++){
      const diaDiv=document.createElement('div');
      diaDiv.classList.add('dia');
      if(d===hoje.getDate() && mes===hoje.getMonth()) diaDiv.classList.add('hoje');
      diaDiv.innerHTML=`<span class="dia-num">${d}</span>`;
      const dataStr=`${ano}-${(mes+1).toString().padStart(2,'0')}-${d.toString().padStart(2,'0')}`;
      const banhosDoDia=banhos.filter(b=>b.data===dataStr && b.status!=='cancelado_sistema');
      banhosDoDia.forEach(b=>{
        const btn=document.createElement('button');
        btn.classList.add('badge',b.tipo);
        if(b.status) btn.classList.add(b.status);
        btn.textContent=`${b.animal} (${b.horario})`;
        diaDiv.appendChild(btn);
      });
      diasGrid.appendChild(diaDiv);
    }
    calendario.appendChild(mesDiv);
  }
}

// Inicialização
renderCalendario();
atualizarTutoresSelect();
renderTutores();
</script>
</body>
</html>
